---
// GooglyLogo.astro
import { useEffect } from 'astro/jsx-runtime';
---

<div class="logo-container" id="googly-logo">
  <div class="eye left"><div class="pupil" id="pupil-left"></div></div>
  <div class="eye right"><div class="pupil" id="pupil-right"></div></div>
</div>

<style>
  .logo-container {
    position: absolute;
    pointer-events: none;
    z-index: 10;
  }

  .eye {
    position: absolute;
    width: 8.75%;
    height: 8.75%;
    background: white;
    border-radius: 50%;
    overflow: hidden;
  }

  .pupil {
    position: absolute;
    width: 15px;
    height: 15px;
    background: black;
    border-radius: 50%;
    top: 12px;
    left: 12px;
    transition: top 0.1s, left 0.1s;
  }

  .eye.left {
    top: 17.2%;
    left: 26.3%;
  }

  .eye.right {
    top: 13.2%;
    left: 37.2%;
  }
</style>

<script type="module">
  function positionLogo() {
    const hero = document.querySelector('.hero');
    const image = hero?.querySelector('img');
    const logo = document.getElementById('googly-logo');

    if (image && logo) {
      const rect = image.getBoundingClientRect();

      logo.style.width = `${rect.width}px`;
      logo.style.height = `${rect.height}px`;
      logo.style.left = `${rect.left + window.scrollX}px`;
      logo.style.top = `${rect.top + window.scrollY}px`;
    }
  }

  window.addEventListener('load', positionLogo);
  window.addEventListener('resize', positionLogo);
</script>

<script>
const maxOffset = 8;
let mouseX = 0;
let mouseY = 0;

document.addEventListener('mousemove', (e) => {
  mouseX = e.clientX;
  mouseY = e.clientY;
});

const pupils = [
  { eye: document.querySelector('.eye.left'), pupil: document.getElementById('pupil-left') },
  { eye: document.querySelector('.eye.right'), pupil: document.getElementById('pupil-right') },
];

function updateEyes() {
  pupils.forEach(({ eye, pupil }) => {
    const rect = eye.getBoundingClientRect();
    const eyeCenterX = rect.left + rect.width / 2;
    const eyeCenterY = rect.top + rect.height / 2;

    const dx = mouseX - eyeCenterX;
    const dy = mouseY - eyeCenterY;
    const angle = Math.atan2(dy, dx);
    const x = Math.cos(angle) * maxOffset;
    const y = Math.sin(angle) * maxOffset;

    pupil.style.left = 12 + x + 'px';
    pupil.style.top = 12 + y + 'px';
  });

  requestAnimationFrame(updateEyes);
}

updateEyes();

</script>
